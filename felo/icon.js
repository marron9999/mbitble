var _icon = [
[[0,1,0,1,0],
 [1,1,1,1,1],
 [1,1,1,1,1],
 [0,1,1,1,0],
 [0,0,1,0,0]],
[[0,0,0,0,0],
 [0,1,0,1,0],
 [0,1,1,1,0],
 [0,0,1,0,0],
 [0,0,0,0,0]],
[[0,0,0,0,0],
 [0,0,0,0,1],
 [0,0,0,1,0],
 [1,0,1,0,0],
 [0,1,0,0,0]],
[[1,0,0,0,1],
 [0,1,0,1,0],
 [0,0,1,0,0],
 [0,1,0,1,0],
 [1,0,0,0,1]],
[[0,0,0,0,0],
 [0,1,0,1,0],
 [0,0,0,0,0],
 [1,0,0,0,1],
 [0,1,1,1,0]],
[[0,0,0,0,0],
 [0,1,0,1,0],
 [0,0,0,0,0],
 [0,1,1,1,0],
 [1,0,0,0,1]],
[[0,0,0,0,0],
 [0,1,0,1,0],
 [0,0,0,0,0],
 [0,1,0,1,0],
 [1,0,1,0,1]],
[[1,0,0,0,1],
 [0,1,0,1,0],
 [0,0,0,0,0],
 [1,1,1,1,1],
 [1,0,1,0,1]],
[[0,0,0,0,0],
 [1,1,0,1,1],
 [0,0,0,0,0],
 [0,1,1,1,0],
 [0,0,0,0,0]],
[[0,1,0,1,0],
 [0,0,0,0,0],
 [0,0,1,0,0],
 [0,1,0,1,0],
 [0,0,1,0,0]],
[[1,0,0,0,1],
 [0,0,0,0,0],
 [1,1,1,1,1],
 [0,0,0,1,1],
 [0,0,0,1,1]],
[[1,1,1,1,1],
 [1,1,0,1,1],
 [0,0,0,0,0],
 [0,1,0,1,0],
 [0,1,1,1,0]],
[[1,1,0,1,1],
 [0,0,0,0,0],
 [0,0,0,1,0],
 [0,0,1,0,0],
 [0,1,0,0,0]],
[[1,1,0,1,1],
 [1,1,1,1,1],
 [0,1,1,1,0],
 [0,1,1,1,0],
 [0,1,1,1,0]],
[[0,0,0,1,1],
 [0,0,0,1,1],
 [1,1,1,1,1],
 [1,1,1,1,1],
 [0,1,0,1,0]],
[[0,1,1,0,0],
 [1,1,1,0,0],
 [0,1,1,1,1],
 [0,1,1,1,0],
 [0,0,0,0,0]],
[[0,0,1,0,0],
 [0,1,1,1,0],
 [1,1,1,1,1],
 [0,1,1,1,0],
 [0,1,0,1,0]],
[[0,0,0,0,0],
 [0,1,1,1,0],
 [1,1,1,1,1],
 [0,1,0,1,0],
 [0,0,0,0,0]],
[[1,1,0,1,1],
 [1,1,1,1,1],
 [0,0,1,0,0],
 [1,1,1,1,1],
 [1,1,0,1,1]],
[[0,0,1,0,0],
 [1,1,1,1,1],
 [0,0,1,0,0],
 [0,1,0,1,0],
 [1,0,0,0,1]],
[[0,1,1,1,0],
 [1,0,1,0,1],
 [1,1,1,1,1],
 [1,1,1,1,1],
 [1,0,1,0,1]],
[[0,0,1,0,0],
 [0,0,1,0,0],
 [0,0,1,0,0],
 [0,1,1,1,0],
 [0,0,1,0,0]],
[[1,1,0,0,0],
 [0,1,0,0,0],
 [0,1,0,0,0],
 [0,1,1,1,0],
 [0,1,0,1,0]],
[[0,1,1,1,0],
 [1,0,1,0,1],
 [1,1,1,1,1],
 [0,1,1,1,0],
 [0,1,1,1,0]],
[[0,1,1,1,0],
 [1,1,1,1,1],
 [0,0,1,0,0],
 [1,0,1,0,0],
 [1,1,1,0,0]],
[[1,1,0,0,0],
 [1,1,0,1,1],
 [0,1,0,1,0],
 [0,1,1,1,0],
 [0,0,0,0,0]],
[[1,0,1,0,0],
 [1,0,1,0,0],
 [1,1,1,1,0],
 [1,1,0,1,0],
 [1,1,1,1,0]],
[[1,0,0,0,1],
 [1,0,0,0,1],
 [1,1,1,1,1],
 [0,1,1,1,0],
 [0,0,1,0,0]],
[[0,0,1,0,0],
 [0,0,1,0,0],
 [0,0,1,0,0],
 [1,1,1,0,0],
 [1,1,1,0,0]],
[ [0,0,1,0,0],
 [0,0,1,1,0],
 [0,0,1,0,1],
 [1,1,1,0,0],
 [1,1,1,0,0]],
[[1,0,1,0,1],
 [1,0,1,0,1],
 [1,1,1,1,1],
 [0,0,1,0,0],
 [0,0,1,0,0]],
[[0,0,1,0,0],
 [0,1,1,1,0],
 [1,1,0,1,1],
 [0,1,1,1,0],
 [0,0,1,0,0]],
[[0,0,0,0,0],
 [0,0,1,0,0],
 [0,1,0,1,0],
 [1,1,1,1,1],
 [0,0,0,0,0]],
[[1,0,0,0,0],
 [1,1,0,0,0],
 [1,0,1,0,0],
 [1,0,0,1,0],
 [1,1,1,1,1]],
[[0,1,0,1,0],
 [1,0,1,0,1],
 [0,1,0,1,0],
 [1,0,1,0,1],
 [0,1,0,1,0]],
[[0,0,1,0,0],
 [0,1,0,1,0],
 [1,0,0,0,1],
 [0,1,0,1,0],
 [0,0,1,0,0]],
[[0,0,0,0,0],
 [0,0,1,0,0],
 [0,1,0,1,0],
 [0,0,1,0,0],
 [0,0,0,0,0]],
[[1,1,1,1,1],
 [1,0,0,0,1],
 [1,0,0,0,1],
 [1,0,0,0,1],
 [1,1,1,1,1]],
[[0,0,0,0,0],
 [0,1,1,1,0],
 [0,1,0,1,0],
 [0,1,1,1,0],
 [0,0,0,0,0]],
[[1,1,0,0,1],
 [1,1,0,1,0],
 [0,0,1,0,0],
 [1,1,0,1,0],
 [1,1,0,0,1]],
];

var LED = [[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],];

function initICON() {
	let h = "<div id=xys>";
	for(let y = 0; y < 5; y++) {
		for(let x = 0; x < 5; x++) {
			h += "<div id=" + y + x + " onclick='clickLED(this)' ontouchend='clickLED(this)'></div>";
		}
	}
	h += "</div>";
	h += "<div id=icon></div>";
	h += "<div id=ico0></div>";
	E("key3").innerHTML = h;
	for(let y=0; y<5; y++) {
		for(let x=0; x<5; x++) {
			if(LED[y][x])
				E("" + y + x).style.background =  "black";
		}
	}
	h = "";
	for(let i=0; i<_icon.length; i++) {
		h += "<div onclick='clickICON(" + i + ")' ontouchend='clickICON(" + i + ")'>";
		for(let y=0; y<5; y++) {
			for(let x=0; x<5; x++) {
				h += "<span class=C" + _icon[i][y][x] + "></span>";
			}
		}
		h += "</div>";
	}
	E("icon").innerHTML = h;
	h = "";
	h += "<div onclick='clickICOX(0)' ontouchend='clickICOX(0)'>⇅</div>";
	h += "<div onclick='clickICOX(1)' ontouchend='clickICOX(1)'>⇆</div>";
	h += "<div onclick='clickICOX(2)' ontouchend='clickICOX(2)' style='transform: rotate(-90deg);'>⤴</div>";
	h += "<div onclick='clickICOX(3)' ontouchend='clickICOX(3)' style='transform: rotate(-90deg);'>⤵</div>";
	E("ico0").innerHTML = h;
}
function arrayICON(icon) {
	let h = "";
	for(let y=0; y<5; y++) {
		let n = 0;
		for(let x=0; x<5; x++) {
			n = n * 2 + icon[y][x];
		}
		n = n.toString(16);
		if(n.length <= 1) n = "0" + n;
		h += n;
	}
	return h;
}
function valueICON(i) {
	return arrayICON(_icon[i]);
}

async function clickICOX(i) {
	event.stopPropagation();
	event.preventDefault();
	let xy = LED;
	LED = [];
	for(let y=0; y<5; y++) {
		LED[y] = [];
		for(let x=0; x<5; x++) {
			if(i == 0) {
				LED[y][x] = xy[4 - y][x];
			} else if(i == 1) {
				LED[y][x] = xy[y][4 - x];
			} else if(i == 2) {
				LED[y][x] = xy[x][4 - y];
			} else {
				LED[y][x] = xy[4 - x][y];
			}
		}
	}
	for(let y=0; y<5; y++) {
		for(let x=0; x<5; x++) {
			E("" + y + x).style.background = (LED[y][x])? "black" : "white";
		}
	}
	fireICON();
}
async function clickICON(i) {
	event.stopPropagation();
	event.preventDefault();
	for(let y=0; y<5; y++) {
		for(let x=0; x<5; x++) {
			LED[y][x] = _icon[i][y][x];
			E("" + y + x).style.background = (LED[y][x])? "black" : "white";
		}
	}
	fireICON();
}
async function clickLED(n) {
	event.stopPropagation();
	event.preventDefault();
	let y = parseInt(n.id);
	let x = y % 10;
	y = parseInt(y / 10);
	LED[y][x] = (LED[y][x] + 1) % 2;
	E(n.id).style.background = (LED[y][x])? "black" : "white";
	fireICON();
}
async function fireICON() {
	if(online == null) return;
	let h = "";
	for(let y=0; y<5; y++) {
		let n = 0;
		for(let x=0; x<5; x++) {
			n = n * 2 + LED[y][x];
		}
		n = n.toString(16);
		if(n.length == 1)
			n = "0" + n;
		h += n;
	}
	OP("@," + h);
}
